<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LibroPrintDriver 관리</title>
    <link rel="stylesheet" href="/web/style.css?v=4">
</head>
<body>
    <!-- Login -->
    <div id="login-view" class="view">
        <div class="login-card">
            <h1>LibroPrintDriver</h1>
            <p class="subtitle">웹 관리 인터페이스</p>
            <form id="login-form">
                <input type="text" id="username" value="admin" placeholder="아이디" autocomplete="username" required>
                <input type="password" id="password" placeholder="비밀번호" autocomplete="current-password" required>
                <button type="submit" class="btn btn-primary">로그인</button>
                <p id="login-error" class="error" hidden></p>
            </form>
        </div>
    </div>

    <!-- Password Change Modal -->
    <div id="password-change-modal" class="modal-overlay" style="display:none">
        <div class="modal-card">
            <h2>비밀번호 변경</h2>
            <p class="subtitle">초기 비밀번호를 변경해주세요 (4자리 이상)</p>
            <input type="password" id="new-password" placeholder="새 비밀번호" autocomplete="new-password">
            <input type="password" id="confirm-password" placeholder="비밀번호 확인" autocomplete="new-password">
            <button class="btn btn-primary" onclick="App.changePassword()">변경</button>
            <p id="pw-change-error" class="error" hidden></p>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard-view" class="view" style="display:none">
        <header>
            <h1>LibroPrintDriver</h1>
            <button id="logout-btn" class="btn btn-sm">로그아웃</button>
        </header>

        <main>
            <!-- Printer Status -->
            <section class="card">
                <h2>프린터 상태</h2>
                <div class="status-grid">
                    <div class="status-item">
                        <span class="status-dot" id="dot-paper"></span>
                        <span>용지</span>
                        <span class="status-label" id="lbl-paper">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-dot" id="dot-cover"></span>
                        <span>커버</span>
                        <span class="status-label" id="lbl-cover">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-dot" id="dot-overheat"></span>
                        <span>과열</span>
                        <span class="status-label" id="lbl-overheat">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-dot" id="dot-connection"></span>
                        <span>연결</span>
                        <span class="status-label" id="lbl-connection">-</span>
                    </div>
                </div>
                <p class="update-time">마지막 갱신: <span id="last-update">-</span></p>
            </section>

            <!-- Actions -->
            <section class="card">
                <h2>프린터 제어</h2>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="App.testPrint()">테스트 인쇄</button>
                    <button class="btn" onclick="App.feed()">용지 이송</button>
                    <button class="btn" onclick="App.cut()">용지 절단</button>
                </div>
                <p id="action-result" class="action-result" hidden></p>
            </section>

            <!-- Device Info -->
            <section class="card">
                <h2>기기 정보</h2>
                <table class="info-table">
                    <tr><td>모델</td><td id="info-model">-</td></tr>
                    <tr><td>Android</td><td id="info-android">-</td></tr>
                    <tr><td>IP 주소</td><td id="info-ip">-</td></tr>
                    <tr><td>앱 버전</td><td id="info-version">-</td></tr>
                    <tr><td>가동 시간</td><td id="info-uptime">-</td></tr>
                </table>
            </section>

            <!-- Settings -->
            <section class="card">
                <h2>설정</h2>

                <div class="setting-row">
                    <label for="setting-url">학교 URL</label>
                    <div class="setting-input-group">
                        <input type="url" id="setting-url" placeholder="https://...">
                    </div>
                </div>

                <div class="setting-row toggle-row">
                    <span>부팅 후 자동실행</span>
                    <label class="toggle"><input type="checkbox" id="setting-autostart"><span class="slider"></span></label>
                </div>

                <div class="setting-row toggle-row">
                    <span>홈 화면 종료버튼 표시</span>
                    <label class="toggle"><input type="checkbox" id="setting-powerbtn"><span class="slider"></span></label>
                </div>

                <div class="setting-row toggle-row">
                    <span>홈 화면 시작/종료시간 표시</span>
                    <label class="toggle"><input type="checkbox" id="setting-schedule-show"><span class="slider"></span></label>
                </div>

                <div class="setting-row">
                    <label>절단 모드</label>
                    <div class="radio-group">
                        <label class="radio-label"><input type="radio" name="cutMode" value="full" id="cut-full" checked> 전체절단</label>
                        <label class="radio-label"><input type="radio" name="cutMode" value="partial" id="cut-partial"> 부분절단</label>
                    </div>
                </div>

                <div class="setting-row">
                    <button class="btn btn-primary" onclick="App.saveSettings()" style="width:100%">설정 저장</button>
                </div>
                <p id="settings-result" class="action-result" hidden></p>
            </section>

            <!-- Password Change -->
            <section class="card">
                <h2>비밀번호 변경</h2>
                <div class="setting-row">
                    <label for="pw-current">현재 비밀번호</label>
                    <input type="password" id="pw-current" class="form-input" placeholder="현재 비밀번호">
                </div>
                <div class="setting-row">
                    <label for="pw-new">새 비밀번호</label>
                    <input type="password" id="pw-new" class="form-input" placeholder="새 비밀번호 (4자리 이상)">
                </div>
                <div class="setting-row">
                    <label for="pw-confirm">비밀번호 확인</label>
                    <input type="password" id="pw-confirm" class="form-input" placeholder="새 비밀번호 확인">
                </div>
                <button class="btn btn-primary" onclick="App.changePasswordFromSettings()" style="width:100%">비밀번호 변경</button>
                <p id="pw-settings-result" class="action-result" hidden></p>
            </section>

            <!-- Schedule -->
            <section class="card">
                <h2>자동 시작/종료 스케줄</h2>
                <p class="card-desc">종료 시간에 자동 전원 OFF, 시작 시간에 RTC 알람으로 자동 전원 ON</p>
                <table class="schedule-table">
                    <thead>
                        <tr><th>요일</th><th>활성</th><th>시작</th><th>종료</th></tr>
                    </thead>
                    <tbody id="schedule-body"></tbody>
                </table>
            </section>
        </main>
    </div>

    <script src="/web/app.js?v=4"></script>
</body>
</html>
